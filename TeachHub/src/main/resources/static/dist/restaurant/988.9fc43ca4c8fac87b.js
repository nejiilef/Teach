"use strict";(self.webpackChunkrestaurant=self.webpackChunkrestaurant||[]).push([[988],{3988:(P,m,l)=>{l.r(m),l.d(m,{DevoirRenduModule:()=>M});var u=l(177),a=l(9417),d=l(7681),e=l(8699),p=l(474);function v(n,s){if(1&n&&(e.j41(0,"strong"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.SpI("Note Totale : ",t.note,"")}}function g(n,s){if(1&n&&(e.j41(0,"strong"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.SpI("Evaluation: ",t.commentaire," ")}}const f=function(n,s){return["/devoirRendu/evaluer",n,s]};function h(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"p",7)(6,"strong"),e.EFF(7),e.k0s(),e.nrm(8,"br"),e.DNE(9,v,2,1,"strong",8),e.nrm(10,"br")(11,"br"),e.DNE(12,g,2,1,"strong",8),e.nrm(13,"br")(14,"br"),e.k0s()(),e.j41(15,"div",9)(16,"button",10),e.bIt("click",function(){const r=e.eBV(t).$implicit,c=e.XpG();return e.Njj(c.downloadRenduPDF(r.etudiant.email))}),e.EFF(17,"T\xe9l\xe9charger"),e.k0s(),e.j41(18,"a",11),e.EFF(19,"\xc9valuer ce devoir"),e.k0s()()()()()()}if(2&n){const t=s.$implicit,o=e.XpG();e.R7$(7),e.JRh(t.etudiant.email),e.R7$(2),e.Y8G("ngIf",null!==t.note),e.R7$(3),e.Y8G("ngIf",null!==t.commentaire),e.R7$(6),e.Y8G("routerLink",e.l_i(4,f,t.idDevoirRendu,o.id))}}let b=(()=>{class n{constructor(t,o,i){this.service=t,this.router=o,this.activatedRoute=i}ngOnInit(){this.activatedRoute.params.subscribe(t=>{this.id=+t.id,this.service.getAllDevoirsRendu(this.id).subscribe(o=>{this.listDevoirRendu=o,console.log(o)})})}downloadRenduPDF(t){this.service.downloadDevoirRenduPDF(+localStorage.getItem("idDevoir"),t).subscribe(o=>{const i=window.URL.createObjectURL(o),r=document.createElement("a");r.href=i,r.download=`rendu_${localStorage.getItem("idDevoir")}.pdf`,r.click()})}viewDevoirDetails(t){this.service.getDevoirRenduById1(t.idDevoirRendu,t.etudiant.email).subscribe(o=>{alert(o?`Note: ${o.note}\nCommentaire: ${o.commentaire}`:"Impossible de r\xe9cup\xe9rer les d\xe9tails du devoir.")})}static#e=this.\u0275fac=function(o){return new(o||n)(e.rXU(p.v),e.rXU(d.Ix),e.rXU(d.nX))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-list-devoir-rendu"]],decls:6,vars:1,consts:[[1,"devoir-container"],["class","devoir-card",4,"ngFor","ngForOf"],[1,"devoir-card"],[1,"card"],[1,"container"],[1,"right"],[1,"text-wrap"],[1,"text-content"],[4,"ngIf"],[1,"button-wrap"],[1,"primary-cta",3,"click"],[1,"primary-cta",3,"routerLink"]],template:function(o,i){1&o&&(e.j41(0,"body")(1,"h1")(2,"b"),e.EFF(3,"Liste de devoirs rendus"),e.k0s()(),e.j41(4,"div",0),e.DNE(5,h,20,7,"div",1),e.k0s()()),2&o&&(e.R7$(5),e.Y8G("ngForOf",i.listDevoirRendu))},dependencies:[u.Sq,u.bT,d.Wk],styles:["html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{padding:20px;margin:0;background-color:#f7f5f1;height:1000px}.devoir-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1.5em}.devoir-card[_ngcontent-%COMP%]{flex:1 1 calc(50% - 1.5em);box-sizing:border-box;margin-bottom:1.5em}.card[_ngcontent-%COMP%]{background-color:#f7f3e9;border-radius:.75em;cursor:pointer;transition:ease .2s;box-shadow:1em 1em 1em #e0dcd0b1,-.75em -.75em 1em #fff;border:1.5px solid #f7f3e9}.card[_ngcontent-%COMP%]:hover{background-color:#e8e1d0;border:1.5px solid #c8b79e}.container[_ngcontent-%COMP%]{margin:1.25em 2em 1.375em 1.375em;display:flex;flex-direction:row;gap:.75em}.text-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25em;color:#4a3f35}.time[_ngcontent-%COMP%]{font-size:.875em;color:#7f7463}.text-link[_ngcontent-%COMP%]{font-weight:500;text-decoration:none;color:#4a3f35}.button-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:1em;align-items:center}.primary-cta[_ngcontent-%COMP%]{font-size:15px;background-color:transparent;font-weight:600;color:#c8b79e;border:none;border-radius:1.5em;cursor:pointer}.primary-cta[_ngcontent-%COMP%]:hover{text-decoration:underline;color:#a89579}h1[_ngcontent-%COMP%]{font-family:Arial,sans-serif;font-size:2.5rem;font-weight:700;color:#5a4a42;text-align:center;margin-bottom:1.5rem;text-transform:uppercase;letter-spacing:.05em;border-bottom:2px solid #dfd3c3;padding-bottom:.5rem}.button-wrap[_ngcontent-%COMP%]{display:flex;gap:1em}.card2[_ngcontent-%COMP%]{width:400px;height:-moz-fit-content;height:fit-content;background:rgb(255,255,255);border-radius:20px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:20px;padding:30px;position:relative;box-shadow:20px 20px 30px #0001}.card-content[_ngcontent-%COMP%]{width:100%;height:-moz-fit-content;height:fit-content;display:flex;flex-direction:column;gap:5px}.card-heading[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#1b1b1b}.card-description[_ngcontent-%COMP%]{font-weight:100;color:#666}.card-button-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;gap:10px}.card-button[_ngcontent-%COMP%]{width:50%;height:35px;border-radius:10px;border:none;cursor:pointer;font-weight:600}.primary[_ngcontent-%COMP%]{background-color:#ff726d;color:#fff}.primary[_ngcontent-%COMP%]:hover{background-color:#ff4942}.secondary[_ngcontent-%COMP%]{background-color:#ddd}.secondary[_ngcontent-%COMP%]:hover{background-color:#c5c5c5}.exit-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border:none;background-color:transparent;position:absolute;top:20px;right:20px;cursor:pointer}.exit-button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:#000}.exit-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#afafaf}.popup-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:1000}"]})}return n})();var x=l(5328);function _(n,s){1&n&&(e.j41(0,"small"),e.EFF(1,"La note est obligatoire."),e.k0s())}function D(n,s){1&n&&(e.j41(0,"small"),e.EFF(1,"La note ne peut pas \xeatre inf\xe9rieure \xe0 0."),e.k0s())}function C(n,s){1&n&&(e.j41(0,"small"),e.EFF(1,"La note d\xe9passe le maximum autoris\xe9."),e.k0s())}function R(n,s){if(1&n&&(e.j41(0,"div",10),e.DNE(1,_,2,0,"small",11),e.DNE(2,D,2,0,"small",11),e.DNE(3,C,2,0,"small",11),e.k0s()),2&n){const t=e.XpG().$implicit;let o,i,r;e.R7$(1),e.Y8G("ngIf",null==(o=t.get("note"))||null==o.errors?null:o.errors.required),e.R7$(1),e.Y8G("ngIf",null==(i=t.get("note"))||null==i.errors?null:i.errors.min),e.R7$(1),e.Y8G("ngIf",null==(r=t.get("note"))||null==r.errors?null:r.errors.max)}}function y(n,s){if(1&n&&(e.j41(0,"div",7)(1,"label"),e.EFF(2),e.k0s(),e.nrm(3,"input",8),e.DNE(4,R,4,3,"div",9),e.k0s()),2&n){const t=s.$implicit,o=s.index,i=e.XpG();let r;e.Y8G("formGroupName",o),e.R7$(2),e.Lme("",i.exercices[o].name," (Max : ",i.exercices[o].maxNote,")"),e.R7$(1),e.Y8G("max",i.exercices[o].maxNote)("min",0),e.R7$(1),e.Y8G("ngIf",(null==(r=t.get("note"))?null:r.invalid)&&(null==(r=t.get("note"))?null:r.touched))}}const O=[{path:"list/:id",component:b},{path:"evaluer/:idDevoirRendu/:id",component:(()=>{class n{constructor(t,o,i,r){this.fb=t,this.route=o,this.devoirRenduService=i,this.devoirserv=r,this.commentaire="",this.exercices=[],this.totalNote=0,this.evaluation={idDevoirRendu:0,note:0,commentaire:""},this.evaluationForm=this.fb.group({exercices:this.fb.array([])})}ngOnInit(){this.route.paramMap.subscribe(t=>{const o=t.get("idDevoirRendu"),i=t.get("id");if(console.log("Param\xe8tres r\xe9cup\xe9r\xe9s - idDevoirRendu:",o,"idDevoir:",i),o&&i){const r=+o;this.idDevoir=+i,console.log("APres convertion number - idDevoirRendu:",r,"idDevoir:",this.idDevoir),this.devoirserv.getDevoirById(this.idDevoir).subscribe(c=>{c?(this.devoir=c,this.commentaire=c.bareme||"",console.log("D\xe9tails du devoirrrrrrrrrr r\xe9cup\xe9r\xe9s:",c)):console.error("Devoir non trouv\xe9")}),console.log("hhhhhhhhhhhhhhhh",r),this.devoirRenduService.getDevoirRenduById(r).subscribe(c=>{c?(this.devoirRendu=c,this.evaluation.idDevoirRendu=r,this.evaluation.note=c.note??0,this.evaluation.commentaire=c.commentaire??""):console.error("Devoir rendu non trouv\xe9")})}else console.error("ID, ID Devoir Rendu ou ID Devoir manquants")}),this.devoirRenduService.getBareme(this.idDevoir).subscribe(t=>{this.exercices=Object.entries(t).map(([o,i])=>({name:o,maxNote:i})),this.createFormFields(),this.updateTotalNote()}),this.evaluationForm.valueChanges.subscribe(()=>{this.updateTotalNote()})}get exercicesArray(){return this.evaluationForm.get("exercices")}createFormFields(){this.exercices.forEach(t=>{this.exercicesArray.push(this.fb.group({name:[t.name],note:[0,[a.k0.required,a.k0.min(0),a.k0.max(t.maxNote)]]}))})}updateTotalNote(){const t=this.exercicesArray.value.map(o=>o.note||0);this.totalNote=t.reduce((o,i)=>o+i,0),this.evaluation.note=this.totalNote}onSubmit(){this.evaluationForm.valid?(this.evaluation.commentaire=this.exercicesArray.value.map(t=>`${t.name} - Note: ${t.note}`).join("\n"),console.log("Donn\xe9es envoy\xe9es:",this.evaluation),this.devoirRenduService.evaluerDevoir(this.evaluation).subscribe(t=>{alert("\xc9valuation soumise avec succ\xe8s"),console.log("R\xe9ponse du serveur:",t)},t=>{console.error("Erreur lors de la soumission de l'\xe9valuation",t)})):alert("Veuillez corriger les erreurs dans le formulaire.")}static#e=this.\u0275fac=function(o){return new(o||n)(e.rXU(a.ok),e.rXU(d.nX),e.rXU(p.v),e.rXU(x.t))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-evaluation-devoir"]],decls:12,vars:4,consts:[[1,"evaluation-page"],[1,"form"],[3,"formGroup","ngSubmit"],["formArrayName","exercices"],[3,"formGroupName",4,"ngFor","ngForOf"],["type","number","disabled","",3,"value"],["type","submit",3,"disabled"],[3,"formGroupName"],["type","number","formControlName","note","required","",3,"max","min"],["class","control",4,"ngIf"],[1,"control"],[4,"ngIf"]],template:function(o,i){1&o&&(e.j41(0,"body")(1,"div",0)(2,"div",1)(3,"form",2),e.bIt("ngSubmit",function(){return i.onSubmit()}),e.j41(4,"div",3),e.DNE(5,y,5,6,"div",4),e.k0s(),e.j41(6,"div")(7,"label"),e.EFF(8,"Note Totale :"),e.k0s(),e.nrm(9,"input",5),e.k0s(),e.j41(10,"button",6),e.EFF(11,"Soumettre"),e.k0s()()()()()),2&o&&(e.R7$(3),e.Y8G("formGroup",i.evaluationForm),e.R7$(2),e.Y8G("ngForOf",i.exercicesArray.controls),e.R7$(4),e.Y8G("value",i.totalNote),e.R7$(1),e.Y8G("disabled",i.evaluationForm.invalid))},dependencies:[u.Sq,u.bT,a.qT,a.me,a.Q0,a.BC,a.cb,a.YS,a.VZ,a.zX,a.j4,a.JD,a.$R,a.v8],styles:[".evaluation-page[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#f4f4f9}.form[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 4px 8px #0000001a;width:100%;max-width:500px}h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%]{display:block;font-weight:700;margin-bottom:5px}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%;padding:10px;font-size:16px;border:1px solid #ddd;border-radius:4px}button[_ngcontent-%COMP%]{width:100%;padding:12px;background-color:#4caf50;color:#fff;border:none;border-radius:4px;font-size:16px;cursor:pointer}button[_ngcontent-%COMP%]:hover{background-color:#45a049}.control[_ngcontent-%COMP%]{color:red}"]})}return n})()}];let F=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.$C({type:n});static#o=this.\u0275inj=e.G2t({imports:[d.iI.forChild(O),d.iI]})}return n})(),M=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.$C({type:n});static#o=this.\u0275inj=e.G2t({imports:[u.MD,F,a.X1,a.YN]})}return n})()}}]);